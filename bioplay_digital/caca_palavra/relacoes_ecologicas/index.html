<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Eco Rela√ß√µes Pro</title>
    <style>
        :root {
            --bg: #1e1b4b; 
            --card: #312e81;
            --accent: #f472b6; 
            --cyan: #22d3ee;
            --purple: #a855f7;
        }
        body { 
            background-color: var(--bg); 
            color: white; 
            font-family: 'Segoe UI', sans-serif; 
            margin: 0; 
            display: flex; 
            flex-direction: column;
            align-items: center; 
            justify-content: center;
            min-height: 100vh;
            touch-action: none;
        }
        .container { 
            background-color: var(--card); 
            padding: 15px; 
            border-radius: 20px; 
            width: 90%; 
            max-width: 380px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.7);
            border: 1px solid rgba(255,255,255,0.1);
        }
        .stats-bar {
            display: flex;
            justify-content: space-between;
            margin-bottom: 12px;
            background: rgba(0,0,0,0.3);
            padding: 10px;
            border-radius: 12px;
            font-weight: bold;
            font-size: 0.9rem;
        }
        .header { 
            text-align: center; 
            background: linear-gradient(135deg, #6366f1, #a855f7); 
            padding: 12px; 
            border-radius: 14px; 
            margin-bottom: 12px;
        }
        .header h1 { font-size: 1.1rem; margin: 0; text-transform: uppercase; letter-spacing: 1px; }
        #grid { 
            display: grid; 
            grid-template-columns: repeat(12, 1fr); 
            gap: 2px; 
            background-color: #4338ca; 
            padding: 5px; 
            border-radius: 10px;
            width: 100%;
            box-sizing: border-box;
        }
        .letter-cell { 
            aspect-ratio: 1/1;
            display: flex; 
            align-items: center; 
            justify-content: center; 
            background-color: var(--card); 
            font-weight: 800; 
            font-size: 13px; 
            border-radius: 3px;
            user-select: none;
        }
        .selected { background-color: var(--cyan) !important; color: var(--bg); }
        .found { background-color: var(--accent) !important; color: white; animation: pulse 0.3s ease; }
        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }
        .word-list { 
            display: grid; 
            grid-template-columns: repeat(3, 1fr); 
            gap: 5px; 
            margin-top: 15px;
            padding: 0;
            list-style: none;
        }
        .word-item { 
            font-size: 9px; 
            background: rgba(0,0,0,0.2); 
            padding: 5px; 
            border-radius: 5px; 
            text-align: center;
            transition: 0.3s;
        }
        .word-found { 
            background: var(--accent) !important; 
            text-decoration: line-through; 
            opacity: 0.6; 
        }
        .btn-reload {
            width: 100%;
            margin-top: 15px;
            padding: 12px;
            border: none;
            border-radius: 10px;
            background: var(--purple);
            color: white;
            font-weight: bold;
            cursor: pointer;
        }
    </style>
</head>
<body>

<div class="container">
    <div class="stats-bar">
        <span>‚è±Ô∏è <span id="timer">00:00</span></span>
        <span style="color: var(--cyan);">üåø PONTOS: <span id="score">0</span></span>
    </div>
    <div class="header"><h1>Rela√ß√µes Ecol√≥gicas</h1></div>
    <div id="grid"></div>

    <ul class="word-list" id="word-list"></ul>
    <button class="btn-reload" onclick="location.reload()">NOVA AN√ÅLISE</button>
</div>

<script>
    // Palavras do tema Rela√ß√µes Ecol√≥gicas
    const displayWords = ["MUTUALISMO", "COMENSALISMO", "PARASITISMO", "PREDATISMO", "SOCIEDADE", "COL√îNIA", "SIMBIOSE", "COMPETI√á√ÉO"];
    
    function removerAcentos(s) {
        return s.normalize('NFD').replace(/[\u0300-\u036f]/g, "").toUpperCase();
    }

    const wordsGrid = displayWords.map(removerAcentos);
    const size = 12;
    let gridData = Array(size).fill().map(() => Array(size).fill(''));
    let selectedCells = [];
    let isSelecting = false;
    let foundCount = 0;
    let score = 0;
    let seconds = 0;

    setInterval(() => {
        if (foundCount < displayWords.length) {
            seconds++;
            let m = Math.floor(seconds / 60).toString().padStart(2, '0');
            let s = (seconds % 60).toString().padStart(2, '0');
            document.getElementById('timer').innerText = `${m}:${s}`;
        }
    }, 1000);

    function getCell(e) {
        let el;
        if (e.touches) {
            el = document.elementFromPoint(e.touches[0].clientX, e.touches[0].clientY);
        } else {
            el = e.target;
        }
        return el && el.classList.contains('letter-cell') ? el : null;
    }

    function start(e) {
        let el = getCell(e);
        if (el) {
            isSelecting = true;
            selectedCells = [el];
            el.classList.add('selected');
        }
    }

    function move(e) {
        if (!isSelecting) return;
        let el = getCell(e);
        if (el && !selectedCells.includes(el)) {
            const first = selectedCells[0];
            if (el.dataset.r === first.dataset.r || el.dataset.c === first.dataset.c) {
                selectedCells.push(el);
                el.classList.add('selected');
            }
        }
    }

    function end() {
        if (!isSelecting) return;
        isSelecting = false;
        const str = selectedCells.map(d => d.textContent).join('');
        const rev = str.split('').reverse().join('');
        const foundIndex = wordsGrid.findIndex(w => w === str || w === rev);

        if (foundIndex !== -1) {
            const wordEl = document.getElementById("word-" + foundIndex);
            if (!wordEl.classList.contains('word-found')) {
                foundCount++;
                score += 150;
                document.getElementById('score').innerText = score;
                selectedCells.forEach(d => { d.classList.remove('selected'); d.classList.add('found'); });
                wordEl.classList.add('word-found');

                if (foundCount === displayWords.length) {
                    setTimeout(() => {
                        alert("üåø ECOSSISTEMA EQUILIBRADO!\n\nTodas as intera√ß√µes foram identificadas!\nPontos: " + score);
                    }, 250);
                }
            }
        } else {
            selectedCells.forEach(d => d.classList.remove('selected'));
        }
        selectedCells = [];
    }

    window.onload = () => {
        const gridEl = document.getElementById('grid');
        const listEl = document.getElementById('word-list');

        displayWords.forEach((word, index) => {
            const li = document.createElement('li');
            li.className = 'word-item';
            li.id = "word-" + index;
            li.innerText = word;
            listEl.appendChild(li);
        });

        wordsGrid.forEach(word => {
            let placed = false;
            let attempts = 0;
            while (!placed && attempts < 200) {
                const dir = Math.random() > 0.5 ? 'H' : 'V';
                const r = Math.floor(Math.random() * (size - (dir === 'V' ? word.length : 0)));
                const c = Math.floor(Math.random() * (size - (dir === 'H' ? word.length : 0)));
                let can = true;
                for (let i = 0; i < word.length; i++) {
                    const nr = dir === 'V' ? r + i : r;
                    const nc = dir === 'H' ? c + i : c;
                    if (gridData[nr][nc] !== '' && gridData[nr][nc] !== word[i]) { can = false; break; }
                }
                if (can) {
                    for (let i = 0; i < word.length; i++) {
                        gridData[dir === 'V' ? r + i : r][dir === 'H' ? c + i : c] = word[i];
                    }
                    placed = true;
                }
                attempts++;
            }
        });

        for (let r = 0; r < size; r++) {
            for (let c = 0; c < size; c++) {
                if (gridData[r][c] === '') gridData[r][c] = "ABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(Math.random() * 26)];
                const div = document.createElement('div');
                div.className = 'letter-cell';
                div.innerText = gridData[r][c];
                div.dataset.r = r;
                div.dataset.c = c;
                gridEl.appendChild(div);
            }
        }

        gridEl.addEventListener('mousedown', start);
        gridEl.addEventListener('mouseover', move);
        window.addEventListener('mouseup', end);
        gridEl.addEventListener('touchstart', (e) => { e.preventDefault(); start(e); }, {passive: false});
        gridEl.addEventListener('touchmove', (e) => { e.preventDefault(); move(e); }, {passive: false});
        gridEl.addEventListener('touchend', end);
    };
</script>
</body>
</html>